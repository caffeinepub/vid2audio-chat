{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 11,
  "summary": "Build an app that converts videos to audio (MP3/WAV) from either video links (embedded or direct) or uploaded video files.",
  "architectural_notes": [
    "In-browser link fetching cannot reliably support YouTube/TikTok due to CORS/auth/anti-bot restrictions; supporting 'any link' may require a server-side fetch/processing pipeline or explicit fallback guidance."
  ],
  "known_issues": [
    "Converting a TikTok short-link URL fails with an \"Unable to access the video URL\" message (CORS/auth/non-direct source limitations).",
    "Uploading a video and converting to MP3 can crash with \"Cannot read properties of null (reading 'copy_buffer')\" (null buffer/FFmpeg processing error).",
    "Scrolling in the app UI is broken/undesirable and needs to be fixed.",
    "YouTube links (e.g., youtu.be/...) are failing with the same \"Unable to access the video\" error as TikTok links (likely due to CORS/auth/anti-bot restrictions on link fetching in-browser).",
    "Current link-conversion approach cannot satisfy the requirement that 'any link' works because YouTube (and similar sources) block direct browser fetching (CORS/anti-bot), forcing download+upload as a workaround."
  ],
  "isFixRequest": true,
  "existing_features": [
    {
      "id": "feature-create-a-conversational-chat-style-ui-where-a-user-can-either-paste-a-video-url-including-embedded-page-urls-or-direct-file-urls-or-upload-a-video-file-and-then-select-an-output-format-mp3-or-wav-to-start-a-conversion",
      "title": "Create a conversational (chat-style) UI where a user can either paste a video URL (including embedded page URLs or direct file URLs) or upload a video file, and then select an output format (MP3 or WAV) to start a conversion.",
      "reqIds": [
        "REQ-1"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-client-side-video-to-audio-conversion-for-uploaded-video-files-into-mp3-and-wav-and-allow-the-user-to-download-the-resulting-audio-file",
      "title": "Implement client-side video-to-audio conversion for uploaded video files into MP3 and WAV, and allow the user to download the resulting audio file.",
      "reqIds": [
        "REQ-2"
      ],
      "version": 1
    },
    {
      "id": "feature-support-converting-a-video-provided-via-a-link-to-mp3-or-wav-by-attempting-to-fetch-the-video-content-in-the-browser-when-possible-and-provide-clear-fallbacks-instructions-when-a-link-cannot-be-accessed-e-g-due-to-cors-auth-or-non-direct-unsupported-sources",
      "title": "Support converting a video provided via a link to MP3 or WAV by attempting to fetch the video content in the browser when possible, and provide clear fallbacks/instructions when a link cannot be accessed (e.g., due to CORS, auth, or non-direct/unsupported sources).",
      "reqIds": [
        "REQ-3"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-conversion-job-history-in-the-ui-within-the-same-chat-thread-that-records-each-conversion-request-and-its-result-success-with-download-link-or-failure-with-reason",
      "title": "Add a conversion job history in the UI (within the same chat thread) that records each conversion request and its result (success with download link, or failure with reason).",
      "reqIds": [
        "REQ-4"
      ],
      "version": 1
    },
    {
      "id": "feature-establish-a-coherent-distinct-visual-theme-for-the-app-colors-typography-spacing-and-component-styling-and-apply-it-consistently-across-the-chat-thread-input-composer-conversion-controls-and-status-states",
      "title": "Establish a coherent, distinct visual theme for the app (colors, typography, spacing, and component styling) and apply it consistently across the chat thread, input composer, conversion controls, and status states.",
      "reqIds": [
        "REQ-5"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-the-mp3-conversion-crash-that-can-occur-when-converting-an-uploaded-video-file-e-g-error-cannot-read-properties-of-null-reading-copy-buffer-by-hardening-the-mp3-encoding-pipeline-so-the-app-either-a-successfully-produces-an-mp3-download-or-b-fails-gracefully-with-a-clear-english-error-message-no-uncaught-exceptions",
      "title": "Fix the MP3 conversion crash that can occur when converting an uploaded video file (e.g., error: \"Cannot read properties of null (reading 'copy_buffer')\") by hardening the MP3 encoding pipeline so the app either (a) successfully produces an MP3 download or (b) fails gracefully with a clear English error message (no uncaught exceptions).",
      "reqIds": [
        "REQ-6"
      ],
      "version": 1
    },
    {
      "id": "feature-improve-link-based-conversion-so-that-when-a-user-provides-a-tiktok-short-link-url-e-g-https-www-tiktok-com-t-zp89kbbbe-the-app-performs-a-best-effort-attempt-to-resolve-the-link-and-fetch-the-underlying-video-content-including-following-redirects-and-tolerating-non-video-content-types-when-the-response-is-still-a-video-blob-and-only-fails-when-it-is-truly-not-accessible",
      "title": "Improve link-based conversion so that when a user provides a TikTok short-link URL (e.g., https://www.tiktok.com/t/ZP89Kbbbe/), the app performs a best-effort attempt to resolve the link and fetch the underlying video content (including following redirects and tolerating non-\"video/*\" content-types when the response is still a video blob), and only fails when it is truly not accessible.",
      "reqIds": [
        "REQ-7"
      ],
      "version": 1
    },
    {
      "id": "feature-update-user-facing-error-messages-for-url-fetch-failures-so-they-remain-in-english-are-specific-about-what-failed-invalid-url-vs-fetch-blocked-vs-non-video-response-and-avoid-promising-no-restrictions-while-still-communicating-that-the-app-will-attempt-multiple-strategies-to-access-links",
      "title": "Update user-facing error messages for URL fetch failures so they remain in English, are specific about what failed (invalid URL vs. fetch blocked vs. non-video response), and avoid promising \"no restrictions\" while still communicating that the app will attempt multiple strategies to access links.",
      "reqIds": [
        "REQ-8"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-the-app-layout-so-the-chat-thread-scrolls-reliably-while-the-header-composer-and-footer-remain-visible-and-do-not-cause-nested-competing-scrollbars",
      "title": "Fix the app layout so the chat thread scrolls reliably while the header, composer, and footer remain visible and do not cause nested/competing scrollbars.",
      "reqIds": [
        "REQ-9"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-the-chat-thread-auto-scroll-behavior-is-user-friendly-keep-the-view-pinned-to-the-latest-job-updates-by-default-but-do-not-forcibly-scroll-if-the-user-has-manually-scrolled-up-to-read-earlier-jobs",
      "title": "Ensure the chat thread auto-scroll behavior is user-friendly: keep the view pinned to the latest job updates by default, but do not forcibly scroll if the user has manually scrolled up to read earlier jobs.",
      "reqIds": [
        "REQ-10"
      ],
      "version": 1
    },
    {
      "id": "feature-make-the-scrolling-behavior-robust-on-mobile-and-small-height-viewports-by-preventing-browser-ui-e-g-mobile-address-bar-from-breaking-the-visible-scrollable-region",
      "title": "Make the scrolling behavior robust on mobile and small-height viewports by preventing browser UI (e.g., mobile address bar) from breaking the visible scrollable region.",
      "reqIds": [
        "REQ-11"
      ],
      "version": 1
    },
    {
      "id": "feature-detect-youtube-and-tiktok-urls-early-in-the-link-conversion-flow-and-fail-fast-with-a-specific-english-error-message-explaining-that-these-sites-typically-cannot-be-fetched-directly-by-the-browser-due-to-cors-auth-anti-bot-restrictions-and-instruct-the-user-to-download-the-video-and-upload-the-file-instead",
      "title": "Detect YouTube and TikTok URLs early in the link-conversion flow and fail fast with a specific, English error message explaining that these sites typically cannot be fetched directly by the browser due to CORS/auth/anti-bot restrictions, and instruct the user to download the video and upload the file instead.",
      "reqIds": [
        "REQ-12"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-url-input-ui-to-proactively-warn-users-in-english-when-they-paste-a-youtube-or-tiktok-link-that-the-app-may-not-be-able-to-access-it-while-still-allowing-them-to-attempt-conversion",
      "title": "Update the URL input UI to proactively warn users (in English) when they paste a YouTube or TikTok link that the app may not be able to access it, while still allowing them to attempt conversion.",
      "reqIds": [
        "REQ-13"
      ],
      "version": 1
    },
    {
      "id": "feature-refine-link-fetch-failure-classification-so-that-when-a-fetch-fails-for-known-restricted-sources-youtube-tiktok-the-app-reports-the-tailored-guidance-instead-of-the-generic-unable-to-access-the-video-message-and-preserves-english-only-user-facing-text",
      "title": "Refine link-fetch failure classification so that when a fetch fails for known restricted sources (YouTube/TikTok), the app reports the tailored guidance instead of the generic \"Unable to access the video\" message, and preserves English-only user-facing text.",
      "reqIds": [
        "REQ-14"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-the-youtube-restricted-source-failure-message-shown-to-users-is-exactly-youtube-videos-cannot-be-accessed-directly-from-the-browser-due-to-cors-restrictions-and-anti-bot-protection-please-download-the-video-using-a-youtube-downloader-and-upload-the-file-directly-and-that-this-message-is-used-consistently-anywhere-the-app-blocks-youtube-link-conversion-including-early-restricted-source-checks-and-any-fetch-failure-classification-that-maps-to-youtube",
      "title": "Ensure the YouTube restricted-source failure message shown to users is exactly: \"YouTube videos cannot be accessed directly from the browser due to CORS restrictions and anti-bot protection. Please download the video using a YouTube downloader and upload the file directly.\" and that this message is used consistently anywhere the app blocks YouTube link conversion (including early restricted-source checks and any fetch-failure classification that maps to YouTube).",
      "reqIds": [
        "REQ-15"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-restricted-source-warning-text-displayed-in-the-url-input-ui-so-it-does-not-imply-that-the-app-can-convert-any-link-and-instead-clearly-communicates-in-english-that-some-sources-including-youtube-commonly-cannot-be-accessed-directly-in-the-browser-and-that-download-upload-is-the-expected-workaround",
      "title": "Update the restricted-source warning text displayed in the URL input UI so it does not imply that the app can convert “any link”, and instead clearly communicates (in English) that some sources (including YouTube) commonly cannot be accessed directly in the browser and that download+upload is the expected workaround.",
      "reqIds": [
        "REQ-16"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Support converting a video provided via any link (embedded or direct) into MP3 or WAV",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-2",
      "summary": "Support converting an uploaded video file into MP3 or WAV",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-3",
      "summary": "Fix scrolling behavior in the app UI (chat thread/conversion flow)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-4",
      "summary": "Enable YouTube (and other restricted-source) link conversion via a server-side/proxy-based workflow instead of in-browser fetching to overcome CORS/anti-bot limitations",
      "reqIds": [],
      "status": "pending"
    }
  ],
  "gameProjectType": "none",
  "projectName": "Vid2Audio Chat",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}